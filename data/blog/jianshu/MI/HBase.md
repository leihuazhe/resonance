`HBase` 以表的形式存储数据。表有行和列组成。列划分为若干个列族(row family)

![结构.png](https://upload-images.jianshu.io/upload_images/6393906-45364b879fa69935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### Row Key

> 每一行的 key。与 `nosql` 数据库一样, row key是用来检索记录的主键。
> 访问 `hbase table `中的行，只有三种方式

- 1 通过单个 row key 访问
- 2 通过 row key 的 range
- 3 全表扫描

`Row key` 行键 可以是任意字符串(最大长度是 64KB，实际应用中长度一般为 10-100bytes)，在hbase内部，row key 保存为**字节数组**。

存储时，数据按照Row key的字典序(byte order)排序存储。设计key时，要充分排序存储这个特性，将经常一起读取的行存储放到一起。(位置相关性)

行的一次读写是原子操作 (不论一次读写多少列)。这个设计决策能够使用户很容易的理解程序在对同一个行进行并发更新操作时的行为。

### 列族 Column Family

hbase 表中的每个列，都归属与某个列族。列族是表的 schema 的一部分(而列不是)，必须在使用表之前定义。列名都以列族作为前缀。例如 `courses:history`，`courses:math` 都属于 `courses` 这个列族。

访问控制、磁盘和内存的使用统计都是在 列族 层面进行的。实际应用中，列族上的控制权限能帮助我们管理不同类型的应用：我们允许一些应用可以添加新的基本数据、一些应用可以读取基本数据并创建继承的列族、一些应用则只允许浏览数据（甚至可能因为隐私的原因不能浏览所有数据）。

### 时间戳 TimeStamp

`HBase` 中通过 `row` 和 `columns` 确定的为一个存贮单元称为 `cell`。每个 `cell` 都保存着同一份数据的多个版本。版本通过时间戳来索引。时间戳的类型是64位整型。时间戳可以由 `hbase` (在**数据写入**时自动 )赋值，此时时间戳是精确到**毫秒**的当前系统时间。时间戳也可以由客户显式赋值。如果应用程序要避免数据版本冲突，就必须自己生成具有**唯一性的时间戳**。每个 `cell` 中，不同版本的数据**按照时间倒序排序**，即**最新**的数据排在**最前**。

为了避免数据存在过多版本造成的的管理 (包括存贮和索引)负担，`hbase` 提供了两种数据版本回收方式，用户可以针对每个列族进行设置。

- 保存数据的最后n个版本，
- 保存最近一段时间内的版本（比如最近七天）。

### Cell

由 {row key, column(= + ), version} 唯一确定的单元。`cell` 中的数据是没有类型的，全部是字节码形式存贮。

更多架构相关： https://www.cnblogs.com/gaopeng527/p/4967186.html
